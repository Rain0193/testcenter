{% extends "data/base.html" %}
{% block title %}首页{% endblock %}
{% load staticfiles %}
{% block content %}
<link rel="stylesheet" href="{% static 'data/assets/css/admin.css' %}">
<link rel="stylesheet" href="http://cdn.amazeui.org/amazeui/2.7.2/css/amazeui.min.css"/>

<div class="admin">
        <div class="admin-index">
            <dl data-am-scrollspy="{animation: 'slide-right', delay: 100}">
                <dt class="qs"><i class="am-icon-users"></i></dt>
                <dd>{{ user_count }}</dd>
                <dd class="f12"><a style="text-decoration: none">注册用户数</a></dd>
            </dl>
            <dl data-am-scrollspy="{animation: 'slide-right', delay: 300}">
                <dt class="hs"><i class="am-icon-server"></i></dt>
                <dd>{{ project_count }}</dd>
                <dd class="f12"><a style="text-decoration: none">项目数</a></dd>
            </dl>
            <dl data-am-scrollspy="{animation: 'slide-right', delay: 600}">
                <dt class="ls"><i class="am-icon-bug"></i></dt>
                <dd>{{ td_count }}</dd>
                <dd class="f12"><a style="text-decoration: none">事务数</a></dd>
            </dl>
            <dl data-am-scrollspy="{animation: 'slide-right', delay: 900}">
                <dt class="cs"><i class="am-icon-area-chart"></i></dt>
                <dd>{{ record_count }}</dd>
                <dd class="f12"><a style="text-decoration: none">事务调用量</a></dd>
            </dl>
        </div>

        <div id="main" style="height:80%; margin-top: 5%;"></div>

    </div>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>

    <script src="http://cdn.amazeui.org/amazeui/2.7.2/js/amazeui.min.js"></script>

    <script type="text/javascript"
            src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
    <script type="text/javascript"
            src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>
    <script>
        var dom = document.getElementById("main");
        var myChart = echarts.init(dom);
        var app = {};
        option = null;
        app.title = '折柱混合';

        option = {
            title : {
                text: '每日事务调用量统计'
            },

            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    crossStyle: {
                        color: '#999'
                    }
                }
            },
            toolbox: {
                show : true,
                feature: {
                    mark : {show: true},
                    dataView: {show: false, readOnly: false},
                    magicType: {show: true, type: ['line', 'bar']},
                    restore: {show: true},
                    saveAsImage: {show: true}
                }
            },
            legend: {
                data: ['事务调用量']
            },
            calculable : true,
            xAxis: [
                {
                    type: 'category',
                    data: [],
                    axisPointer: {
                        type: 'shadow'
                    }
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    data: []
                }
            ],
            series: [
                {
                    name: '事务调用量',
                    type: 'line',
                    data: [],
                    markPoint : {
                        data : [
                            {type : 'max', name: '最大值'},
                            {type : 'min', name: '最小值'}
                        ]
                    }
                }
            ]
        };
        if (option && typeof option === "object") {
            var xAxis_data = get_date_xAxis();
            option.xAxis[0].data = xAxis_data;
            option.series[0].data = {{ total.yDatas }};
            myChart.setOption(option, true);
        }

        function get_date_xAxis() {
            var data = [];
            for (var i = 0; i < 12; i++) {
                data[i] = getDay(i)
            }
            return data.reverse();
        }

        function getDay(day) {
            var today = new Date();
            var targetday_milliseconds = today.getTime() + 1000 * 60 * 60 * 24 * day * -1;
            today.setTime(targetday_milliseconds); //注意，这行是关键代码
            var tYear = today.getFullYear();
            var tMonth = today.getMonth();
            var tDate = today.getDate();
            tMonth = doHandleMonth(tMonth + 1);
            tDate = doHandleMonth(tDate);
            return tYear + "-" + tMonth + "-" + tDate;
        }

        function doHandleMonth(month) {
            var m = month;
            if (month.toString().length === 1) {
                m = "0" + month;
            }
            return m;
        }
    </script>



{% endblock %}